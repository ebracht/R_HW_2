setwd("~/Downloads/R_HW_2")
#Read csv
historical_spending <- read_csv("historical_spending.csv")
library(tidyverse)
library(ggplot2)
#Read csv
historical_spending <- read_csv("historical_spending.csv")
historical_spending_long <- historical_spending %>%
pivot_longer(cols = c(Candy, Flowers, Jewelry, GreetingCards, EveningOut, Clothing, GiftCards),
names_to = "GiftType",
values_to = "Spending")
graph <- ggplot(historical_spending_long, aes(x = Year, y = Spending, color = GiftType)) +
geom_point() +
geom_smooth(method = "lm", se = TRUE) + #show line of best fit, method=lm to indicate a       linear model and se=TRUE to show confidence   interval around the line
scale_x_continuous(limits = c(2010, 2022),  # Set x-axis limits, use continuous to scale x   because Year is a numeric variable and we have a small range
breaks = seq(2010, 2022, by = 2)) +  # labels increase by 2 so axis is   not overly cluttered
labs(title = "Valentine's Day Spending by Gift Type", #add graph title
x = "Year",  #add x-axis title
y = "Avg Spending per Person ($)") #add y-axis title
# Print the graph
print(graph)
graph2 <- ggplot(historical_spending_long, aes(x = Year, y = Spending, color = GiftType)) +
geom_line() +
scale_x_continuous(limits = c(2010, 2022),  # Set x-axis limits, use continuous to scale x   because Year is a numeric variable and we have a small range
breaks = seq(2010, 2022, by = 2)) +  # labels increase by 2 so axis is   not overly cluttered
labs(title = "Valentine's Day Spending by Gift Type", #add graph title
x = "Year",  #add x-axis title
y = "Avg Spending per Person ($)") #add y-axis title
print(graph2)
install.packages("plotly")
library(plotly)
interactive_graph <- ggplotly(graph)
interactive_graph2 <- ggplotly(graph2)
interactive_graph
interactive_graph2
